{"version":3,"file":"static/js/2009.76b58fa7.chunk.js","mappings":"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","sources":["Layouts/Main/MyAssets/EditMediaModal/EditMediaModal.js"],"sourcesContent":["import React, { Component } from 'react';\r\nimport AWS from 'aws-sdk'\r\nimport { connect } from \"react-redux\";\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { Modal } from 'react-bootstrap';\r\nimport FilerobotImageEditor, { TABS, TOOLS, } from 'react-filerobot-image-editor';\r\nimport { postPostUpdateAction } from '../../../../Services/Actions/assetsActions'\r\n\r\nconst uppyKey = '0701d3d7f8d94e92a65a9cba388b1d96';\r\nconst uppyBucket = 'cloud.taggbox.com';\r\nconst uppyAwsKey = '47ABVORKG52UYE1KB28S';\r\nconst uppyAwsSecret = 'pcaTfeokaz28geAAns08H3yaGbOVz6ILgTptu19v';\r\nconst companionUrl = 'https://test.taggbox.com';\r\n\r\n\r\nconst S3_BUCKET = uppyBucket;\r\nconst REGION = \"us-west-1\";\r\n\r\nAWS.config.update({\r\n    accessKeyId: uppyAwsKey,\r\n    secretAccessKey: uppyAwsSecret\r\n})\r\n\r\nconst myBucket = new AWS.S3({\r\n    robot: \"/wasabi/store\",\r\n    params: { Bucket: S3_BUCKET },\r\n    region: REGION,\r\n    endpoint: 'https://s3.us-west-1.wasabisys.com',\r\n})\r\n\r\n\r\nfunction dataURItoBlob(dataURI) {\r\n    var binary = window.atob(dataURI.split(',')[1]);\r\n    var array = [];\r\n    for (var i = 0; i < binary.length; i++) {\r\n        array.push(binary.charCodeAt(i));\r\n    }\r\n    return new Blob([new Uint8Array(array)], {\r\n        type: 'image/jpg'\r\n    });\r\n}\r\n\r\n\r\n\r\nclass EditMediaModal extends Component {\r\n    state = { newImage: null }\r\n    handleClose = () => {\r\n        this.props.editMediaCallback(false)\r\n    };\r\n\r\n    onSaveData = (editedImageObject, designState) => {\r\n        var self = this;\r\n        if (editedImageObject.imageBase64 && Object.keys(editedImageObject).length > 0) {\r\n            var myFile = dataURItoBlob(editedImageObject.imageBase64);\r\n            var newFileName = `onsiteupload/images/${uuidv4()}.${editedImageObject.extension}`\r\n            const params = {\r\n                ACL: 'public-read',\r\n                Body: myFile,\r\n                Bucket: S3_BUCKET,\r\n                ContentType: 'image/png',\r\n                ContentEncoding: 'base64',\r\n                Key: newFileName\r\n            };\r\n            myBucket.upload(params)\r\n                .on('httpUploadProgress', (evt) => {\r\n                    console.log(\"evt\", Math.round((evt.loaded / evt.total) * 100))\r\n                    if (Math.round((evt.loaded / evt.total) * 100) == 100) {\r\n                        self.setState({ newImage: `https://cloud.taggbox.com/${newFileName}` }, () => self.onClickToPostEditIMage())\r\n                    }\r\n\r\n                })\r\n                .send((err) => {\r\n                    if (err) console.log(err)\r\n                })\r\n        }\r\n\r\n    }\r\n    onClickToPostEditIMage = () => {\r\n        const { modalAssetData } = this.props;\r\n        const { newImage } = this.state;\r\n        const data = {\r\n            \"action\": \"4\",\r\n            \"source\": modalAssetData.collection,\r\n            \"destination\": String(modalAssetData.collection),\r\n            \"postId\": String(modalAssetData.id),\r\n            \"postFile\": newImage ? newImage : modalAssetData.postFile,\r\n            \"tags\": modalAssetData.tags,\r\n            \"content\": modalAssetData.content\r\n        }\r\n        this.props.postPostUpdateAction(data, () => {\r\n            this.props.editMediaCallback(false)\r\n        })\r\n\r\n    }\r\n    render() {\r\n        const { editMediaModal, modalAssetData, editMediaCallback } = this.props\r\n\r\n        return <Modal size={'full'} show={editMediaModal} className=\"editMedia_modal border-0 p-0\" backdrop={false} onHide={editMediaCallback(false)}>\r\n            <Modal.Header className=\"border-0 p-0 w-100 border-bottom\" closeButton>\r\n                <div className=\"d-flex justify-content-between align-items-center px-lg-3 px-2 bg-white w-100\">\r\n                    <div className=\"d-flex align-items-center flex-wrap\">\r\n                        <h1 className=\"text-dark font-weight-bold mr-4 fs-6 mb-0\">Edit Image</h1>\r\n                    </div>\r\n                </div>\r\n            </Modal.Header>\r\n            <Modal.Body className=\"p-0 align-items-stretch justify-content-center\">\r\n                <FilerobotImageEditor\r\n                    className=\"edit_asset_\"\r\n                    source={modalAssetData.postFile}\r\n                    theme={{\r\n                        palette: {\r\n                            //'bg-secondary': '#ffffff',\r\n                            'bg-primary': '#F4F5FA',\r\n                            // 'bg-primary-active': '#e5e6eb',\r\n                            'accent-primary': '#313A53',\r\n                            'accent-primary-hover': '#000',\r\n                            'accent-primary-active': '#313A53',\r\n                            'icons-primary': '#313A53',\r\n                            'icons-primary-hover': '#313A53',\r\n                            // 'icons-secondary': 'red',\r\n                            'borders-secondary': 'red',\r\n                            'borders-primary': 'red',\r\n                            'borders-strong': 'red',\r\n                            // 'light-shadow': 'red',\r\n                            // 'warning': 'red',\r\n                        },\r\n                        typography: {\r\n                            fontFamily: 'Manrope, sans-serif',\r\n                        },\r\n                    }}\r\n                    onSave={this.onSaveData}\r\n                    //onClose={closeImgEditor}\r\n                    annotationsCommon={{\r\n                        fill: '#000000',\r\n                        stroke: '#000000',\r\n                        strokeWidth: 0,\r\n                        shadowOffsetX: 0,\r\n                        shadowOffsetY: 0,\r\n                        shadowBlur: 0,\r\n                        shadowColor: '#000000',\r\n                        shadowOpacity: 1,\r\n                        text: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit.',\r\n                        fontSize: 14,\r\n                        letterSpacing: 0,\r\n                        align: 'left',\r\n                        fontStyle: 'normal',\r\n                    }}\r\n                    Text={{ text: 'Image Editor...' }}\r\n                    Rotate={{ angle: 90, componentType: 'slider' }}\r\n                    Crop={{\r\n                        autoResize: true,\r\n                        presetsItems: [\r\n                            {\r\n                                titleKey: 'classicTv',\r\n                                descriptionKey: '4:3',\r\n                                ratio: 4 / 3,\r\n                                icon: <div>ss</div>,\r\n                            },\r\n                            {\r\n                                titleKey: 'cinemascope',\r\n                                descriptionKey: '21:9',\r\n                                ratio: 21 / 9,\r\n                                icon: <div>29</div>, // optional\r\n                            },\r\n                        ],\r\n                        presetsFolders: [\r\n                            {\r\n                                titleKey: 'socialMedia', // will be translated into Social Media as backend contains this translation key\r\n                                icon: <>test</>, // React Function component, string or HTML Element\r\n                                groups: [\r\n                                    {\r\n                                        titleKey: 'facebook',\r\n                                        items: [\r\n                                            {\r\n                                                titleKey: 'profile',\r\n                                                width: 180,\r\n                                                height: 180,\r\n                                                descriptionKey: 'fbProfilePhotoSize',\r\n                                            },\r\n                                            {\r\n                                                titleKey: 'coverPhoto',\r\n                                                width: 820,\r\n                                                height: 312,\r\n                                                descriptionKey: 'fbCoverPhotoSize',\r\n                                            },\r\n                                        ],\r\n                                    },\r\n                                ],\r\n                            },\r\n                        ],\r\n                    }}\r\n                    tabsIds={[TABS.FILTERS, TABS.ADJUST, TABS.RESIZE, TABS.ANNOTATE, TABS.FINETUNE, TOOLS.TEXT]} // or {['Adjust', 'Annotate', 'Watermark']}\r\n                    defaultTabId={TABS.FILTERS} // or 'Annotate'\r\n                    defaultToolId={TOOLS.TEXT} // or 'Text'\r\n                    defaultResizeId={TOOLS.RESIZE}\r\n                />\r\n            </Modal.Body>\r\n        </Modal>\r\n    }\r\n}\r\n\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        postPostUpdateAction: (data, calback) => dispatch(postPostUpdateAction(data, calback)),\r\n    }\r\n}\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EditMediaModal);\r\n\r\n"],"names":["S3_BUCKET","AWS","accessKeyId","secretAccessKey","myBucket","robot","params","Bucket","region","endpoint","dataURItoBlob","dataURI","binary","window","atob","split","array","i","length","push","charCodeAt","Blob","Uint8Array","type","EditMediaModal","state","newImage","handleClose","props","editMediaCallback","onSaveData","editedImageObject","designState","self","imageBase64","Object","keys","myFile","newFileName","uuidv4","extension","ACL","Body","ContentType","ContentEncoding","Key","upload","on","evt","console","log","Math","round","loaded","total","setState","onClickToPostEditIMage","send","err","modalAssetData","data","collection","String","id","postFile","tags","content","postPostUpdateAction","this","editMediaModal","size","show","className","backdrop","onHide","closeButton","source","theme","palette","typography","fontFamily","onSave","annotationsCommon","fill","stroke","strokeWidth","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","shadowOpacity","text","fontSize","letterSpacing","align","fontStyle","Text","Rotate","angle","componentType","Crop","autoResize","presetsItems","titleKey","descriptionKey","ratio","icon","presetsFolders","groups","items","width","height","tabsIds","TABS","TOOLS","defaultTabId","defaultToolId","defaultResizeId","Component","connect","dispatch","calback"],"sourceRoot":""}